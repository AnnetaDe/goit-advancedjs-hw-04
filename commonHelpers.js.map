{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export * from \"./pixabay-api.js\";\n\n// lib imports\nimport axios from \"axios\";\nimport flatpickr from \"flatpickr\";\nimport iziToast from \"izitoast\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst API_KEY = \"3024031-50bf2ca6b1e9bc3513f045fb3\";\n\nexport async function getImages(query, page) {\n  let currentPage = 1;\n  let qtyPerPage = 15;\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    per_page: qtyPerPage,\n    page\n  });\n  const baseUrl = `https://pixabay.com/api/?${searchParams.toString()}`;\n  return axios.get(baseUrl);\n}\n\n\n","import iziToast from \"izitoast\";\n\nexport const scroll = () => {\n  document.querySelector(\".bottom-scroll\")?.scrollIntoView({ behavior: \"smooth\" });\n};\n\nexport const scrollUp = () => {\n  document.querySelector(\".top-scroll\")?.scrollIntoView({ behavior: \"smooth\" });\n};\n\nexport const renderItemsMarkup = hits => hits.map(hit => `\n  <li class=\"gallery-item\">\n    <div class=\"img-container\">\n      <a class=\"image-link\" href=\"${hit.largeImageURL}\">\n        <img class=\"image\" src=\"${hit.webformatURL}\" alt=\"${hit.tags}\" />\n      </a>\n    </div>\n    <ul class=\"under-picture-list\">\n      <li class=\"under-picture-info-item\">Likes <span class=\"data-received\">${hit.likes}</span></li>\n      <li class=\"under-picture-info-item\">Views <span class=\"data-received\">${hit.views}</span></li>\n      <li class=\"under-picture-info-item\">Comments <span class=\"data-received\">${hit.comments}</span></li>\n      <li class=\"under-picture-info-item\">Downloads <span class=\"data-received\">${hit.downloads}</span></li>\n    </ul>\n  </li>\n`).join(\"\");\n\nexport const refreshGallery = (galleryEl, formEl, errorMessage) => {\n  galleryEl.innerHTML = \"\";\n  formEl.reset();\n  iziToast.error({\n    message: errorMessage,\n    position: \"topRight\",\n    timeout: 2000\n  });\n};\n\nexport const removeLoadMoreBtn = btn => {\n  btn.classList.add(\"is-hidden\");\n  btn.replaceWith(btn.cloneNode(true)); // removes all listeners safely\n};\n\nexport const showLoadMoreBtn = (btn, loadMoreText) => {\n  btn.classList.remove(\"is-hidden\");\n  btn.innerHTML = `<span class=\"load-more-text\">${loadMoreText}</span>`;\n\n};\n\nexport const showLoader = loaderEl => {\n  loaderEl.classList.add(\"is-visible\");\n};\n\nexport const hideLoader = loaderEl => {\n  loaderEl.classList.remove(\"is-visible\");\n};\n\nexport const showToast = (message, position = \"topRight\", timeout = 5000) => {\n  iziToast.show({\n    message,\n    position,\n    timeout\n  });\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport { getImages } from \"./js/pixabay-api.js\";\nimport {\n  renderItemsMarkup,\n  scroll,\n  removeLoadMoreBtn,\n  showLoadMoreBtn,\n  refreshGallery,\n  showLoader,\n  hideLoader,\n  showToast\n} from \"./js/render-functions.js\";\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const searchForm = document.querySelector(\".form\");\n  const galleryEl = document.querySelector(\".gallery\");\n  const loaderEl = document.querySelector(\".loader\");\n  const loadMoreImagesBtn = document.querySelector(\".load-more-images-btn\");\n  const scrollUpBtn = document.querySelector(\".scroll-to-top-btn\");\n  const userInput = document.querySelector(\"#user-search-input\");\n\n  const perPage = 15;\n  let currentPage = 1;\n  let totalPages = 0;\n  let totalImages = 0;\n  let totalHits = 0;\n  let query = \"\";\n\n  const lightbox = new SimpleLightbox(\".image-link\", {\n    captionsData: \"alt\",\n    captionDelay: 250,\n  });\n\n  loadMoreImagesBtn.classList.add(\"is-hidden\");\n\n  const onSearchFormSubmit = async (event) => {\n    event.preventDefault();\n    query = event.target.elements.picture_search.value.trim();\n    currentPage = 1;\n\n    if (query === \"\") {\n      refreshGallery(galleryEl, searchForm, \"Please enter a query.\");\n      return;\n    }\n\n    galleryEl.innerHTML = \"\";\n    showLoader(loaderEl);\n\n    try {\n      const response = await getImages(query, currentPage, perPage);\n      hideLoader(loaderEl);\n      userInput.value = \"\";\n\n      if (response.status !== 200 || !response.data) {\n        refreshGallery(galleryEl, searchForm, \"Error fetching images.\");\n        return;\n      }\n\n      const hits = response.data.hits;\n      totalHits = response.data.totalHits;\n      totalImages = response.data.total;\n      totalPages = Math.ceil(totalHits / perPage);\n\n      if (hits.length === 0) {\n        refreshGallery(galleryEl, searchForm, \"No images found.\");\n        return;\n      }\n\n      galleryEl.innerHTML = renderItemsMarkup(hits);\n      lightbox.refresh();\n\n      if (totalHits <= perPage) {\n        removeLoadMoreBtn(loadMoreImagesBtn);\n        showToast(\"We're sorry, but you've reached the end of search results.\");\n      } else {\n        const remaining = totalImages - currentPage * perPage;\n        const text = `Load more images ${remaining} of ${totalImages}`;\n        showLoadMoreBtn(loadMoreImagesBtn, text);\n      }\n\n    } catch (error) {\n      hideLoader(loaderEl);\n      removeLoadMoreBtn(loadMoreImagesBtn);\n      refreshGallery(galleryEl, searchForm, \"Error fetching images.\");\n      console.error(error);\n    }\n  };\n\n  const onLoadMoreBtnClick = async () => {\n    currentPage++;\n    showLoader(loaderEl);\n\n    try {\n      const response = await getImages(query, currentPage, perPage);\n      hideLoader(loaderEl);\n\n      if (response.status !== 200 || !response.data) {\n        refreshGallery(galleryEl, searchForm, \"Error fetching images.\");\n        return;\n      }\n\n      const hits = response.data.hits;\n      galleryEl.insertAdjacentHTML(\"beforeend\", renderItemsMarkup(hits));\n      lightbox.refresh();\n      scroll();\n\n      const remaining = totalImages - currentPage * perPage;\n      const text = `Load more images ${remaining} of ${totalImages}`;\n\n      if (currentPage >= totalPages) {\n        removeLoadMoreBtn(loadMoreImagesBtn);\n        showToast(\"You've reached the end of search results.\");\n      } else {\n        showLoadMoreBtn(loadMoreImagesBtn, text);\n      }\n\n    } catch (error) {\n      hideLoader(loaderEl);\n      console.error(error);\n    }\n  };\n\n  // Scroll-up button logic\n  window.addEventListener(\"scroll\", () => {\n    scrollUpBtn.classList.toggle(\"is-hidden\", window.scrollY <= 400);\n  });\n\n  scrollUpBtn.addEventListener(\"click\", () => {\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\n  });\n\n  searchForm.addEventListener(\"submit\", onSearchFormSubmit);\n  loadMoreImagesBtn.addEventListener(\"click\", onLoadMoreBtnClick);\n});"],"names":["API_KEY","getImages","query","page","qtyPerPage","baseUrl","axios","scroll","_a","renderItemsMarkup","hits","hit","refreshGallery","galleryEl","formEl","errorMessage","iziToast","removeLoadMoreBtn","btn","showLoadMoreBtn","loadMoreText","showLoader","loaderEl","hideLoader","showToast","message","position","timeout","searchForm","loadMoreImagesBtn","scrollUpBtn","userInput","perPage","currentPage","totalPages","totalImages","totalHits","lightbox","SimpleLightbox","onSearchFormSubmit","event","response","text","error","onLoadMoreBtnClick"],"mappings":"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"}