{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export * from \"./pixabay-api.js\";\n\n// lib imports\nimport axios from \"axios\";\nimport flatpickr from \"flatpickr\";\nimport iziToast from \"izitoast\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst API_KEY = \"3024031-50bf2ca6b1e9bc3513f045fb3\";\n\nexport async function getImages(query, page) {\n  let currentPage = 1;\n  let qtyPerPage = 15;\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    per_page: qtyPerPage,\n    page\n  });\n  const baseUrl = `https://pixabay.com/api/?${searchParams.toString()}`;\n  return axios.get(baseUrl);\n}\n\n\n","import iziToast from \"izitoast\";\n\nexport const scroll = () => {\n  document.querySelector(\".bottom-scroll\")?.scrollIntoView({ behavior: \"smooth\" });\n};\n\nexport const scrollUp = () => {\n  document.querySelector(\".top-scroll\")?.scrollIntoView({ behavior: \"smooth\" });\n};\n\nexport const renderItemsMarkup = hits => hits.map(hit => `\n  <li class=\"gallery-item\">\n    <div class=\"img-container\">\n      <a class=\"image-link\" href=\"${hit.largeImageURL}\">\n        <img class=\"image\" src=\"${hit.webformatURL}\" alt=\"${hit.tags}\" />\n      </a>\n    </div>\n    <ul class=\"under-picture-list\">\n      <li class=\"under-picture-info-item\">Likes <span class=\"data-received\">${hit.likes}</span></li>\n      <li class=\"under-picture-info-item\">Views <span class=\"data-received\">${hit.views}</span></li>\n      <li class=\"under-picture-info-item\">Comments <span class=\"data-received\">${hit.comments}</span></li>\n      <li class=\"under-picture-info-item\">Downloads <span class=\"data-received\">${hit.downloads}</span></li>\n    </ul>\n  </li>\n`).join(\"\");\n\nexport const refreshGallery = (galleryEl, formEl, errorMessage) => {\n  galleryEl.innerHTML = \"\";\n  formEl.reset();\n  iziToast.error({\n    message: errorMessage,\n    position: \"topRight\",\n    timeout: 2000\n  });\n};\n\nexport const removeLoadMoreBtn = btn => {\n  btn.classList.add(\"is-hidden\");\n  btn.replaceWith(btn.cloneNode(true)); // removes all listeners safely\n};\n\nexport const showLoadMoreBtn = (btn, loadMoreText) => {\n  btn.classList.remove(\"is-hidden\");\n  btn.innerHTML = `<span class=\"load-more-text\">${loadMoreText}</span>`;\n\n};\n\nexport const showLoader = loaderEl => {\n  loaderEl.classList.add(\"is-visible\");\n};\n\nexport const hideLoader = loaderEl => {\n  loaderEl.classList.remove(\"is-visible\");\n};\n\nexport const showToast = (message, position = \"topRight\", timeout = 5000) => {\n  iziToast.show({\n    message,\n    position,\n    timeout\n  });\n}","// import \"./js/pixabay-api.js\";\n// import \"./js/render-functions.js\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport { getImages } from \"./js/pixabay-api.js\";\nimport { renderItemsMarkup, scroll, removeLoadMoreBtn, showLoadMoreBtn,refreshGallery, showLoader, hideLoader, showToast  } from \"./js/render-functions.js\";\n\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    const searchForm = document.querySelector(\".form\");\n    const galleryEl = document.querySelector(\".gallery\");\n    const loaderEl = document.querySelector(\".loader\");\n    const loadMoreImagesBtn = document.querySelector(\".load-more-images-btn\");\n\n    const scrollUpBtn = document.querySelector(\".scroll-to-top-btn\");\n    loadMoreImagesBtn.classList.add(\"is-hidden\");\n\n    const userInput = document.querySelector(\"#user-search-input\");\n  \n    let currentPage = 1;\n    let totalPages = 0;\n    let totalImages = 0;\n    let totalHits = 0;\n    let query = \"\";\n    const perPage = 15; \n\n    let loadMoreText = `Load more images ${totalImages - currentPage * perPage} of ${totalImages}`;\n\n    let lightbox = new SimpleLightbox(\".image-link\", {\n      captionsData: \"alt\",\n      captionDelay: 250,\n    });\n  \n    loadMoreImagesBtn.classList.add(\"is-hidden\");\n  const onSearchFormSubmit = async event => {\n    try {\n      event.preventDefault();\n      query = event.target.elements.picture_search.value.trim();\n      currentPage = 1;\n  \n      if (!lightbox) {\n        lightbox = new SimpleLightbox(\".image-link\", {\n          focus: true,\n          captionsData: \"alt\",\n          captionDelay: 250\n        });\n      }\n  \n      if (query === \"\") {\n        refreshGallery(event.target, \"Please enter a query.\");\n        return;\n      }\n  \n      galleryEl.innerHTML = \"\";\n        showLoader(loaderEl);\n      const response = await getImages(query, currentPage, perPage);\n      console.log(response);\n      totalImages = response.data.total;\n        if (response.status !== 200) {\n            hideLoader(loaderEl);\n            refreshGallery(event.target, \"Error fetching images. Please try again.\");\n            return;\n        }\n        if (!response || !response.data) {\n            refreshGallery(event.target, \"No images found. Please enter another query.\");\n            return;\n        }\n      hideLoader(loaderEl);\n      userInput.value = \"\";\n  \n      if (response.data.hits.length === 0) {\n        refreshGallery(\n          event.target,\n          \"No images found. Please enter another query.\"\n        );\n        return;\n      }\n  \n      galleryEl.innerHTML = renderItemsMarkup(response.data.hits);\n      lightbox.refresh();\n  \n      totalHits = response.data.totalHits;\n      console.log(`Total hits: ${totalHits}`);\n      totalPages = Math.ceil(totalHits / perPage);\n      console.log(`Total pages: ${totalPages}`);\n\n\n      if (totalHits <= perPage) {\n        removeLoadMoreBtn();\n        showToast(\"We're sorry, but you've reached the end of search results.\");\n      } else {\n        loadMoreText = `Load more images ${totalImages - currentPage * perPage} of ${totalImages}`;\n        showLoadMoreBtn(loadMoreImagesBtn, loadMoreText);\n      }\n  \n    } catch (error) {\n      hideLoader(loaderEl);\n      const remaining = totalImages - currentPage * perPage;\n        loadMoreText = `Load more images ${remaining} of ${totalImages}`;\n\n        removeLoadMoreBtn(loadMoreImagesBtn);\n        refreshGallery(event.target, \"Error fetching images. Please try again.\");\n\n      console.error(error);\n    }\n  };\n\n  const onLoadMoreBtnClick = async () => {\n    try {\n      currentPage++;\n      showLoader(loaderEl);\n        loadMoreText = `Load more images ${totalImages - currentPage * perPage} of ${totalImages}`;\n      const response = await getImages(query, currentPage, perPage);\n\n        console.log(currentPage, totalPages);\n        if (response.status !== 200) {\n            hideLoader(loaderEl);\n            refreshGallery(target, \"Error fetching images. Please try again.\");\n            return;\n        }\n        if (!response || !response.data) {\n            refreshGallery(target, \"No images found. Please enter another query.\");\n            return;\n        }\n      hideLoader(loaderEl);\n\n\n      galleryEl.insertAdjacentHTML(\n        \"beforeend\",\n        renderItemsMarkup(response.data.hits)\n      );\n      lightbox.refresh();\n      scroll();\n      const remaining = totalImages - currentPage * perPage;\n      const text = `Load more images ${remaining} of ${totalImages}`;\n  \n        if (currentPage >= totalPages) {\n            removeLoadMoreBtn(loadMoreImagesBtn);\n            showToast(\"We're sorry, but you've reached the end of search results.\");\n        }\n        else {\n            showLoadMoreBtn(loadMoreImagesBtn, text);\n        }\n  \n    } catch (error) {\n      hideLoader(loaderEl);\n      console.error(error);\n    }\n  };\n  searchForm.addEventListener(\"submit\", onSearchFormSubmit);\nloadMoreImagesBtn.addEventListener(\"click\", onLoadMoreBtnClick);\nwindow.addEventListener(\"scroll\", () => {\n    if (window.scrollY > 400) {\n      scrollUpBtn.classList.remove(\"is-hidden\");\n    } else {\n      scrollUpBtn.classList.add(\"is-hidden\");\n    }\n  });\n  \n  scrollUpBtn.addEventListener(\"click\", () => {\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\n  });\n\n  });\n\n\n\n\n"],"names":["API_KEY","getImages","query","page","qtyPerPage","baseUrl","axios","scroll","_a","renderItemsMarkup","hits","hit","refreshGallery","galleryEl","formEl","errorMessage","iziToast","removeLoadMoreBtn","btn","showLoadMoreBtn","loadMoreText","showLoader","loaderEl","hideLoader","showToast","message","position","timeout","searchForm","loadMoreImagesBtn","scrollUpBtn","userInput","currentPage","totalPages","totalImages","totalHits","perPage","lightbox","SimpleLightbox","onSearchFormSubmit","event","response","error","onLoadMoreBtnClick","text"],"mappings":"owBASA,MAAMA,EAAU,oCAET,eAAeC,EAAUC,EAAOC,EAAM,CAE3C,IAAIC,EAAa,GAUjB,MAAMC,EAAU,4BATK,IAAI,gBAAgB,CACvC,IAAKL,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAUE,EACV,KAAAD,CACJ,CAAG,EACwD,SAAQ,CAAE,GACnE,OAAOG,EAAM,IAAID,CAAO,CAC1B,CCvBO,MAAME,EAAS,IAAM,QAC1BC,EAAA,SAAS,cAAc,gBAAgB,IAAvC,MAAAA,EAA0C,eAAe,CAAE,SAAU,QAAQ,EAC/E,EAMaC,EAAoBC,GAAQA,EAAK,IAAIC,GAAO;AAAA;AAAA;AAAA,oCAGrBA,EAAI,aAAa;AAAA,kCACnBA,EAAI,YAAY,UAAUA,EAAI,IAAI;AAAA;AAAA;AAAA;AAAA,8EAIUA,EAAI,KAAK;AAAA,8EACTA,EAAI,KAAK;AAAA,iFACNA,EAAI,QAAQ;AAAA,kFACXA,EAAI,SAAS;AAAA;AAAA;AAAA,CAG9F,EAAE,KAAK,EAAE,EAEGC,EAAiB,CAACC,EAAWC,EAAQC,IAAiB,CACjEF,EAAU,UAAY,GACtBC,EAAO,MAAK,EACZE,EAAS,MAAM,CACb,QAASD,EACT,SAAU,WACV,QAAS,GACb,CAAG,CACH,EAEaE,EAAoBC,GAAO,CACtCA,EAAI,UAAU,IAAI,WAAW,EAC7BA,EAAI,YAAYA,EAAI,UAAU,EAAI,CAAC,CACrC,EAEaC,EAAkB,CAACD,EAAKE,IAAiB,CACpDF,EAAI,UAAU,OAAO,WAAW,EAChCA,EAAI,UAAY,gCAAgCE,CAAY,SAE9D,EAEaC,EAAaC,GAAY,CACpCA,EAAS,UAAU,IAAI,YAAY,CACrC,EAEaC,EAAaD,GAAY,CACpCA,EAAS,UAAU,OAAO,YAAY,CACxC,EAEaE,EAAY,CAACC,EAASC,EAAW,WAAYC,EAAU,MAAS,CAC3EX,EAAS,KAAK,CACZ,QAAAS,EACA,SAAAC,EACA,QAAAC,CACJ,CAAG,CACH,ECpDA,SAAS,iBAAiB,mBAAoB,IAAM,CAChD,MAAMC,EAAa,SAAS,cAAc,OAAO,EAC3Cf,EAAY,SAAS,cAAc,UAAU,EAC7CS,EAAW,SAAS,cAAc,SAAS,EAC3CO,EAAoB,SAAS,cAAc,uBAAuB,EAElEC,EAAc,SAAS,cAAc,oBAAoB,EAC/DD,EAAkB,UAAU,IAAI,WAAW,EAE3C,MAAME,EAAY,SAAS,cAAc,oBAAoB,EAE7D,IAAIC,EAAc,EACdC,EAAa,EACbC,EAAc,EACdC,EAAY,EACZjC,EAAQ,GACZ,MAAMkC,EAAU,GAEhB,IAAIhB,EAAe,oBAAoBc,EAAcF,EAAcI,CAAO,OAAOF,CAAW,GAExFG,EAAW,IAAIC,EAAe,cAAe,CAC/C,aAAc,MACd,aAAc,GACpB,CAAK,EAEDT,EAAkB,UAAU,IAAI,WAAW,EAC7C,MAAMU,EAAqB,MAAMC,GAAS,CACxC,GAAI,CAaF,GAZAA,EAAM,eAAc,EACpBtC,EAAQsC,EAAM,OAAO,SAAS,eAAe,MAAM,OACnDR,EAAc,EAETK,IACHA,EAAW,IAAIC,EAAe,cAAe,CAC3C,MAAO,GACP,aAAc,MACd,aAAc,GACxB,CAAS,GAGCpC,IAAU,GAAI,CAChBU,EAAe4B,EAAM,OAAQ,uBAAuB,EACpD,MACD,CAED3B,EAAU,UAAY,GACpBQ,EAAWC,CAAQ,EACrB,MAAMmB,EAAW,MAAMxC,EAAUC,EAAO8B,EAAaI,CAAO,EAG1D,GAFF,QAAQ,IAAIK,CAAQ,EACpBP,EAAcO,EAAS,KAAK,MACtBA,EAAS,SAAW,IAAK,CACzBlB,EAAWD,CAAQ,EACnBV,EAAe4B,EAAM,OAAQ,0CAA0C,EACvE,MACH,CACD,GAAI,CAACC,GAAY,CAACA,EAAS,KAAM,CAC7B7B,EAAe4B,EAAM,OAAQ,8CAA8C,EAC3E,MACH,CAIH,GAHAjB,EAAWD,CAAQ,EACnBS,EAAU,MAAQ,GAEdU,EAAS,KAAK,KAAK,SAAW,EAAG,CACnC7B,EACE4B,EAAM,OACN,8CACV,EACQ,MACD,CAED3B,EAAU,UAAYJ,EAAkBgC,EAAS,KAAK,IAAI,EAC1DJ,EAAS,QAAO,EAEhBF,EAAYM,EAAS,KAAK,UAC1B,QAAQ,IAAI,eAAeN,CAAS,EAAE,EACtCF,EAAa,KAAK,KAAKE,EAAYC,CAAO,EAC1C,QAAQ,IAAI,gBAAgBH,CAAU,EAAE,EAGpCE,GAAaC,GACfnB,IACAO,EAAU,4DAA4D,IAEtEJ,EAAe,oBAAoBc,EAAcF,EAAcI,CAAO,OAAOF,CAAW,GACxFf,EAAgBU,EAAmBT,CAAY,EAGlD,OAAQsB,EAAO,CACdnB,EAAWD,CAAQ,EAEjBF,EAAe,oBADCc,EAAcF,EAAcI,CACA,OAAOF,CAAW,GAE9DjB,EAAkBY,CAAiB,EACnCjB,EAAe4B,EAAM,OAAQ,0CAA0C,EAEzE,QAAQ,MAAME,CAAK,CACpB,CACL,EAEQC,EAAqB,SAAY,CACrC,GAAI,CACFX,IACAX,EAAWC,CAAQ,EACjBF,EAAe,oBAAoBc,EAAcF,EAAcI,CAAO,OAAOF,CAAW,GAC1F,MAAMO,EAAW,MAAMxC,EAAUC,EAAO8B,EAAaI,CAAO,EAG1D,GADA,QAAQ,IAAIJ,EAAaC,CAAU,EAC/BQ,EAAS,SAAW,IAAK,CACzBlB,EAAWD,CAAQ,EACnBV,EAAe,OAAQ,0CAA0C,EACjE,MACH,CACD,GAAI,CAAC6B,GAAY,CAACA,EAAS,KAAM,CAC7B7B,EAAe,OAAQ,8CAA8C,EACrE,MACH,CACHW,EAAWD,CAAQ,EAGnBT,EAAU,mBACR,YACAJ,EAAkBgC,EAAS,KAAK,IAAI,CAC5C,EACMJ,EAAS,QAAO,EAChB9B,IAEA,MAAMqC,EAAO,oBADKV,EAAcF,EAAcI,CACJ,OAAOF,CAAW,GAEtDF,GAAeC,GACfhB,EAAkBY,CAAiB,EACnCL,EAAU,4DAA4D,GAGtEL,EAAgBU,EAAmBe,CAAI,CAG9C,OAAQF,EAAO,CACdnB,EAAWD,CAAQ,EACnB,QAAQ,MAAMoB,CAAK,CACpB,CACL,EACEd,EAAW,iBAAiB,SAAUW,CAAkB,EAC1DV,EAAkB,iBAAiB,QAASc,CAAkB,EAC9D,OAAO,iBAAiB,SAAU,IAAM,CAChC,OAAO,QAAU,IACnBb,EAAY,UAAU,OAAO,WAAW,EAExCA,EAAY,UAAU,IAAI,WAAW,CAE3C,CAAG,EAEDA,EAAY,iBAAiB,QAAS,IAAM,CAC1C,OAAO,SAAS,CAAE,IAAK,EAAG,SAAU,QAAQ,CAAE,CAClD,CAAG,CAEH,CAAG"}