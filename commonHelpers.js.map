{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js"],"sourcesContent":["export * from \"./pixabay-api.js\";\n\n// lib imports\nimport axios from \"axios\";\nimport flatpickr from \"flatpickr\";\nimport iziToast from \"izitoast\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst API_KEY = \"3024031-50bf2ca6b1e9bc3513f045fb3\";\n\nexport async function getImages(query, page) {\n  let currentPage = 1;\n  let qtyPerPage = 15;\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    per_page: qtyPerPage,\n    page\n  });\n  const baseUrl = `https://pixabay.com/api/?${searchParams.toString()}`;\n  return axios.get(baseUrl);\n}\n\nexport async function loadMore(query, page) {\n  let currentPage = 1;\n  let qtyPerPage = 15;\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    per_page: qtyPerPage,\n    page: currentPage\n  });\n\n  const baseUrl = `https://pixabay.com/api/?${searchParams.toString()}`;\n  return axios.get(baseUrl);\n}\n","export * from \"./render-functions.js\";\n\n// library imports\n// import axios from \"axios\"; // Remove unused import\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\n\n// function imports\nimport { getImages } from \"./pixabay-api.js\";\nimport { loadMore } from \"./pixabay-api.js\";\nimport simpleLightbox from \"simplelightbox\";\n\n// local variables\nconst searchForm = document.querySelector(\".search-form\");\nconst galleryEl = document.querySelector(\".picture-and-data-list\");\nconst pictureCard = document.querySelector(\".picture-and-data-item\");\nconst loaderEl = document.querySelector(\".loader\");\nconst loadMoreImagesBtn = document.querySelector(\".load-more-images-btn\");\nloadMoreImagesBtn.classList.add(\"is-hidden\");\nlet query = \"\";\nlet currentPage = 1;\n\nconst scroll=()=>{\n  const scroll= document.querySelector('.bottom-scroll')\n  scroll.scrollIntoView({\n    \n    behavior: 'smooth',\n  });\n}\n  \n\nconst lightbox = new SimpleLightbox(\".image-link\", {\n  focus: true,\n  captionsData: \"alt\",\n  captionDelay: 250\n});\n\nfunction renderItemsMarkup(hits) {\n  const galleryItemsMarkup = hits\n    .map(hit => {\n      return `\n    <li class=\"picture-and-data-item\">\n    <div class=\"img-container\">\n          <a  class=\"image-link\" href=\"${hit.largeImageURL}\"><img class=\"image\" src=\"${hit.webformatURL}\" alt=\"${hit.tags}\" />\n          </div>\n          <ul class=\"under-picture-list\">\n              <li class=\"under-picture-info-item\">Likes <span class=\"data-received\">${hit.likes}</span></li>\n              <li class=\"under-picture-info-item\">Views <span class=\"data-received\">${hit.views}</span></li>\n              <li class=\"under-picture-info-item\">Comments <span class=\"data-received\">${hit.comments}</span></li>\n              <li class=\"under-picture-info-item\">Downloads <span class=\"data-received\">${hit.downloads}</span></li>\n          </ul>\n      </li> \n      </a>`;\n    })\n    .join(\"\");\n  return galleryItemsMarkup;\n}\n\nconst removeLoadMoreBtn = () => {\n  loadMoreImagesBtn.classList.add(\"is-hidden\");\n  loadMoreImagesBtn.removeEventListener(\"click\", onLoadMoreBtnClick);\n};\n\nconst showLoadMoreBtn = () => {\n  loadMoreImagesBtn.classList.remove(\"is-hidden\");\n  loadMoreImagesBtn.addEventListener(\"click\", onLoadMoreBtnClick);\n};\nconst refreshGallery = (searchForm, errorMessage) => {\n  galleryEl.innerHTML = \"\";\n\n  searchForm.reset();\n\n  iziToast.error({\n    message: errorMessage,\n    position: \"topRight\",\n    timeout: 2000\n  });\n\n  removeLoadMoreBtn();\n};\n\nconst onSearchFormSubmit = async event => {\n  try {\n    event.preventDefault();\n    query = event.target.elements.picture_search.value.trim();\n    currentPage = 1;\n    if (query === \"\") {\n      refreshGallery(event.target, \"Please enter a query.\");\n      return;\n    }\n    galleryEl.innerHTML = \"\";\n    loaderEl.classList.add(\"is-visible\");\n    const response = await getImages(query, currentPage);\n    loaderEl.classList.remove(\"is-visible\");\n\n    if (response.data.hits.length === 0) {\n      refreshGallery(\n        event.target,\n        \"No images found. Please enter another query.\"\n      );\n      return;\n      \n    }\n   \n    \n    \n    if (response.data.totalHits <= 15) {\n      console.log(response.data.totalHits);\n      galleryEl.insertAdjacentHTML(\n        \"beforeend\",\n        renderItemsMarkup(response.data.hits)\n      );\n      return;\n    }\n\n    if (response.data.totalHits > 15) {\n      galleryEl.innerHTML = renderItemsMarkup(response.data.hits);\n      showLoadMoreBtn();\n      loadMoreImagesBtn.addEventListener(\"click\", onLoadMoreBtnClick);\n      \n      \n      \n\n\n    }\n    const lightbox = new SimpleLightbox(\".image-link\", {\n      focus: true,\n      captionsData: \"alt\",\n      captionDelay: 250\n    });\n  } catch (error) {\n    loaderEl.classList.remove(\"is-visible\");\n    console.log(error);\n  }\n};\n\nconst onLoadMoreBtnClick = async event => {\n  try {\n    currentPage += 1;\n    const response = await getImages(query, currentPage);\n    galleryEl.insertAdjacentHTML(\n      \"beforeend\",\n      renderItemsMarkup(response.data.hits)\n    );\n    lightbox.refresh();\n    scroll();\n    \n   \n\n    let totalPages = Math.ceil(response.data.totalHits / 15);\n\n    if (currentPage === totalPages) {\n      removeLoadMoreBtn();\n      refreshGallery(\n        event.target,\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n  } catch (error) {\n    loaderEl.classList.remove(\"is-visible\");\n    console.log(error);\n  }\n};\n\nsearchForm.addEventListener(\"submit\", onSearchFormSubmit);\n\nsearchForm.addEventListener(\"reset\", event => {\n  if (event.target === searchForm) {\n    searchForm.reset();\n  }\n});\n"],"names":["API_KEY","getImages","query","page","qtyPerPage","baseUrl","axios","searchForm","galleryEl","loaderEl","loadMoreImagesBtn","currentPage","scroll","lightbox","SimpleLightbox","renderItemsMarkup","hits","hit","removeLoadMoreBtn","onLoadMoreBtnClick","showLoadMoreBtn","refreshGallery","errorMessage","iziToast","onSearchFormSubmit","event","response","error","totalPages"],"mappings":"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"}